<?xml version="1.0" encoding="UTF-8"?>
<!--
      Contains service beans.
      Copyright (c) 2014 University of Oxford
-->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="modelWrapperUrls" class="org.springframework.util.StringUtils" factory-method="tokenizeToStringArray">
        <constructor-arg type="java.lang.String" value="${model.wrapper.instance.list}"/>
        <constructor-arg type="java.lang.String" value=" "/>
    </bean>

    <!-- Core services -->
    <bean id="alertService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.core.AlertServiceImpl" autowire="constructor"/>
    <bean id="diseaseService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.core.DiseaseServiceImpl" autowire="constructor"/>
    <bean id="expertService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.core.ExpertServiceImpl" autowire="constructor"/>
    <bean id="locationService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.core.LocationServiceImpl" autowire="constructor"/>
    <bean id="modelRunService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.core.ModelRunServiceImpl" autowire="constructor">
        <constructor-arg name="daysBetweenModelRuns" value="${days.between.model.runs}" />
    </bean>
    <import resource="classpath:uk/ac/ox/zoo/seeg/abraid/mp/common/config/beans-email-service.xml"/>

    <!-- Business workflow services -->
    <bean id="diseaseOccurrenceValidationService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.DiseaseOccurrenceValidationServiceImpl" autowire="constructor"/>
    <bean id="modelRunWorkflowService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.ModelRunWorkflowServiceImpl" autowire="constructor"/>

    <!-- Business workflow support -->
    <bean id="automaticModelRunsEnabler" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.AutomaticModelRunsEnabler" autowire="constructor"/>
    <bean id="diseaseExtentGenerator" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.DiseaseExtentGenerator" autowire="constructor"/>
    <bean id="weightingsCalculator" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.WeightingsCalculator" autowire="constructor"/>
    <bean id="diseaseOccurrenceReviewManager" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.DiseaseOccurrenceReviewManager" autowire="constructor">
        <constructor-arg name="maxDaysOnValidator" value="${max.days.for.occurrences.on.validator}" />
    </bean>
    <bean id="modelRunRequester" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.ModelRunRequester" autowire="constructor">
        <constructor-arg name="modelWrapperUrlCollection" ref="modelWrapperUrls" />
    </bean>
    <bean id="environmentalSuitabilityHelper" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.EnvironmentalSuitabilityHelper" autowire="constructor"/>
    <bean id="distanceFromDiseaseExtentHelper" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.DistanceFromDiseaseExtentHelper" autowire="constructor"/>
    <bean id="machineWeightingPredictor" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.MachineWeightingPredictor" autowire="constructor"/>

    <!-- Web services -->
    <bean id="modelWrapperWebService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.ModelWrapperWebService" autowire="constructor" />
    <bean id="modelWrapperWebServiceAsyncWrapper" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.ModelWrapperWebServiceAsyncWrapper" autowire="constructor" >
        <constructor-arg name="modelWrapperUrlCollection" ref="modelWrapperUrls" />
    </bean>

    <bean id="machineLearningWebService" class="uk.ac.ox.zoo.seeg.abraid.mp.common.service.workflow.support.MachineLearningWebService" autowire="constructor">
        <constructor-arg name="rootUrl" value="${machinelearning.root.url}"/>
    </bean>

</beans>
